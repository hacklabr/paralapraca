{% extends "base.html" %}
{% load pipeline %}
{% load i18n %}
{% load in_group %}
{% load append_to_get %}

{% block js %}
{{ block.super }}
    {% javascript 'users_admin' %}
    <script>
        window.total_users_found = {{ total_users_number }};
    </script>
{% endblock %}

{% block wrapper_classes %}
wrapper-course-lesson
{% endblock %}

{% block body_attrs %}
ng-app="users-admin"
{% endblock %}

{% block content %}
<!-- COURSES -->
<section class="users" ng-app="users-admin" ng-controller="UsersAdminController">
    <!-- ACTIONS -->
    <div class="actions-menu actions-menu-message" ng-hide="alert.hidden" fixed-bar>
        <div class="container">
            {% include 'administration/_alert.html' %}
        </div>
    </div>
    <!-- END ACTIONS -->
    <div class="users-content page container-fluid">
        <div class="page-breadcrumb">
            Administração > Usuários e grupos
        </div>
        <!--  HEADER -->
        <header class="page-header">
            <h2>{% trans 'Administração de usuários e grupos' %}</h2>
        </header>
        <!-- END HEADER -->
        
        <div class="filters">
            <form role="form" class="form-inline" method="GET">
                <div class="form-group">
                    <label class="sr-only" for="keyword">{% trans 'Keyword' %}</label>
                    <input type="text"
                           placeholder="{% trans 'Digite uma palavra-chave' %}"
                           class="form-control" id="keyword"
                           name="keyword"
                           ng-model="filters.keyword">
                </div>
                <div class="form-group filter-checkbox">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" name="admin" ng-model="filters.admin"> {% trans 'Administrators' %}
                        </label>
                        <label>
                            <input type="checkbox" name="admin" ng-model="filters.blocked"> {% trans 'Inativos' %}
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <button class="btn btn-sm btn-primary search" ng-click="filter_users()">{% trans 'Buscar' %}</button>
                </div>
            </form>
            <!-- END FORM INLINE -->
        </div>
        <!-- END FILTERS -->
        <ul class="nav nav-tabs">
            <li class="active">
                <a href="#users" data-toggle="tab">
                    {% trans "Users" %}
                </a>
            </li>
            <li>
                <a href="#groups" data-toggle="tab">
                    {% trans "Groups" %}
                </a>
            </li>
        </ul>
        
        <div class="tab-content">
            <div class="tab-pane fade in active users-list" id="users">

                <h3>Lista de usuários</h3>
                
                <div class="col-lg-12" ng-hide="users_page.$resolved">
                    <p>{% trans 'Loading users list' %}... <i class="loading fa fa-refresh fa-spin"></i></p>
                </div>
                <div class="col-lg-12" ng-if="users_page.$resolved && users_page.length==0">
                    <p>{% trans 'No users found' %}.</p>
                </div>
                <section ng-show="users_page.$resolved">
                    <p class="total">Total de {% verbatim %}<span>{{ total_users_found }}{% endverbatim %} usuários cadastrados</span></p>
                    <table>
                        <thead>
                            <tr>
                                <th class="username-email">{% trans "Nome e e-mail de usuário" %}</th>
                                <th class="fullname">{% trans "Nome completo" %}</th>
                                <th class="groups">{% trans "Grupos" %}</th>
                                <th class="role">{% trans 'Administrator' %}</th>
                                <th class="active">{% trans 'Active' %}</th>
                                <th class="actions">{% trans "Actions" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="user in users_page">
                            {% verbatim %}
                                <td>
                                    <div class="user-icon">
                                        <img src="{{ user.picture }}" alt="{{ user.name }}">
                                    </div>
                                    <b>{{ user.name }}</b><br>
                                    ({{ user.email }})
                                </td>
                                <td>{{ user.name }} {{ user.get_full_name }}</td>
                                <td><b>Maracanaú, Avante, Olinda, Assessoras</b></td>
                                <td class="text-center">
                                    <input type="checkbox" ng-model="user.is_superuser" ng-change="update_user(user)">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" ng-model="user.is_active" ng-change="update_user(user)">
                                </td>
                                <td class="textcenter">
                                    <button class="btn btn-danger btn-inverse trash js-delete" ng-click="delete_user(user, $index)"></button>
                                </td>
                            {% endverbatim %}
                            </tr>
                        </tbody>
                    </table>
                </section>

                <pagination total-items="total_users_found"
                            items-per-page="50"
                            ng-model="current_page"
                            ng-change="page_changed()"
                            max-size="5"
                            boundary-links="true"
                            previous-text="{% trans 'Previous' %}"
                            next-text="{% trans 'Next' %}"
                            first-text="{% trans 'First' %}"
                            last-text="{% trans 'Last' %}"
                        	ng-hide="filtered">
                </pagination>
            </div>

            <div class="tab-pane fade in groups-list" id="groups">
                <section>
                    <h3>Lista de grupos</h3>

                    <p class="total">Total de <span>xxxx grupos cadastrados</span></p>

                    <div class="row header">
                        <div class="col-sm-3 col-lg-4">nome do grupo</div>
                        <div class="col-sm-3 col-lg-3">número de membros</div>
                    </div>

                    <div class="row group">
                        <div class="col-sm-3 col-lg-4 group-name">Adisciping lorem ipsum</div>
                        <div class="col-sm-3 col-lg-3 members-number">5 membros</div>
                        <div class="col-sm-6 col-lg-5 actions">
                            <button class="btn btn-sm btn-primary btn-inverse add">adicionar membros</button>
                            <button class="btn btn-sm btn-primary btn-inverse"
                                    ng-init="show_members=false"
                                    ng-click="show_members=!show_members"
                            >
                                    ver membros
                                    <i class="fa" ng-class="{'fa fa-caret-down':!show_members,'fa fa-caret-up':show_members}"></i>
                            </button>
                            <button class="btn btn-danger btn-inverse trash"></button>
                        </div>

                        <div class="container-fluid members" ng-show="show_members">
                            <div class="row member-line">
                                <div class="col-sm-5">
                                    <div class="member-info">
                                        <div class="user-icon">
                                            <img src="{{ user.picture }}" alt="{{ user.name }}">
                                        </div>
                                        <b>Cecília Ramos Rodrigues</b><br>
                                        (ceci.ramos@dominio.com.br)
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <button class="btn btn-sm btn-danger btn-inverse delete">remover do grupo</button>
                                </div>
                            </div>

                            <div class="row member-line">
                                <div class="col-sm-5">
                                    <div class="member-info">
                                        <div class="user-icon">
                                            <img src="{{ user.picture }}" alt="{{ user.name }}">
                                        </div>
                                        <b>Cecília Ramos Rodrigues</b><br>
                                        (ceci.ramos@dominio.com.br)
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <button class="btn btn-sm btn-danger btn-inverse delete">remover do grupo</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row group">
                        <div class="col-sm-3 col-lg-4 group-name">Adisciping lorem ipsum</div>
                        <div class="col-sm-3 col-lg-3 members-number">5 membros</div>
                        <div class="col-sm-6 col-lg-5 actions">
                            <button class="btn btn-sm btn-primary btn-inverse add">adicionar membros</button>
                            <button class="btn btn-sm btn-primary btn-inverse"
                                    ng-init="show_members=false"
                                    ng-click="show_members=!show_members"
                            >
                                    ver membros
                                    <i class="fa" ng-class="{'fa fa-caret-down':!show_members,'fa fa-caret-up':show_members}"></i>
                            </button>
                            <button class="btn btn-danger btn-inverse trash"></button>
                        </div>

                        <div class="container-fluid members" ng-show="show_members">
                            <div class="row member-line">
                                <div class="col-sm-5">
                                    <div class="member-info">
                                        <div class="user-icon">
                                            <img src="{{ user.picture }}" alt="{{ user.name }}">
                                        </div>
                                        <b>Cecília Ramos Rodrigues</b><br>
                                        (ceci.ramos@dominio.com.br)
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <button class="btn btn-sm btn-danger btn-inverse delete">remover do grupo</button>
                                </div>
                            </div>

                            <div class="row member-line">
                                <div class="col-sm-5">
                                    <div class="member-info">
                                        <div class="user-icon">
                                            <img src="{{ user.picture }}" alt="{{ user.name }}">
                                        </div>
                                        <b>Cecília Ramos Rodrigues</b><br>
                                        (ceci.ramos@dominio.com.br)
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <button class="btn btn-sm btn-danger btn-inverse delete">remover do grupo</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <pagination total-items="total_users_found"
                            items-per-page="50"
                            ng-model="current_page"
                            ng-change="page_changed()"
                            max-size="5"
                            boundary-links="true"
                            previous-text="{% trans 'Previous' %}"
                            next-text="{% trans 'Next' %}"
                            first-text="{% trans 'First' %}"
                            last-text="{% trans 'Last' %}"
                            ng-hide="filtered">
                </pagination>
            </div>
        </div>
    </div>

</section>
<!-- END COURSES -->
{% endblock %}
